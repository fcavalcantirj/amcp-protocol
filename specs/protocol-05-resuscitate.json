{
  "category": "amcp-protocol",
  "description": "Verify signature, decrypt, return content + secrets",
  "steps": [
    "resuscitate(checkpointPath, identity) -> { header, content, secrets }",
    "identity: { aid, publicKey, privateKey }",
    "Process:",
    "  1. Parse checkpoint: extract header and encryptedPayload",
    "  2. Validate header.version === 2",
    "  3. Validate header.aid === identity.aid (my checkpoint?)",
    "  4. VERIFY SIGNATURE FIRST:",
    "     verify(encryptedPayload, header.signature, identity.publicKey)",
    "  5. If signature invalid → REJECT with error 'not authentic'",
    "  6. If valid → decrypt payload using identity.privateKey",
    "  7. Return { header, content: payload.content, secrets: payload.secrets }",
    "Protocol does NOT inject secrets - enforcer's job",
    "CLI: amcp resuscitate --checkpoint <path> --identity <path> --out-content <dir> --out-secrets <json>",
    "Verify: Invalid signature throws 'not authentic' error",
    "Verify: Wrong AID throws 'not my checkpoint' error",
    "Verify: Valid checkpoint decrypts and returns correctly",
    "Verify: Secrets have target info preserved"
  ],
  "passes": false
}
