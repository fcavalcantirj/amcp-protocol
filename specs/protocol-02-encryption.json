{
  "category": "amcp-protocol",
  "description": "Encryption primitives for AMCP checkpoints",
  "steps": [
    "deriveKey(privateKey, salt='amcp-checkpoint-v2') -> 256-bit key via HKDF-SHA256",
    "Note: Ed25519 privateKey (32 bytes) used as HKDF input keying material",
    "This derives a separate AES key from the signing key (KISS approach for v1)",
    "encrypt(payload: object, privateKey) -> base64:",
    "  1. JSON.stringify(payload)",
    "  2. Generate random 12-byte IV",
    "  3. AES-256-GCM encrypt with derived key",
    "  4. Return base64(IV + ciphertext + authTag)",
    "decrypt(encrypted: base64, privateKey) -> object:",
    "  1. Decode base64",
    "  2. Extract IV (12 bytes), authTag (16 bytes), ciphertext",
    "  3. AES-256-GCM decrypt",
    "  4. JSON.parse and return",
    "Verify: encryptâ†’decrypt returns original",
    "Verify: Wrong key throws error",
    "Verify: Tampered data fails authTag check"
  ],
  "passes": false
}
